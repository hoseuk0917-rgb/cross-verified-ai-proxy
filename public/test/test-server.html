<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<title>Cross-Verified AI Proxy Test v10.5.0</title>
<style>
  body { font-family: Arial; margin: 20px; background: #f7f9fb; color: #333; }
  input, button { padding: 8px; margin: 4px; }
  pre { background: #fff; border: 1px solid #ddd; padding: 10px; overflow-x: auto; }
</style>
</head>
<body>
  <h2>Cross-Verified AI Proxy Test Console</h2>

  <label>Email: <input id="email" value="hoseuk0917@gmail.com" /></label>
  <label>Name: <input id="name" value="고호석" /></label>
  <button onclick="getToken()">1️⃣ 토큰 발급</button>

  <p>Token: <span id="tokenDisplay">(없음)</span></p>

  <button onclick="verifyToken()">2️⃣ 토큰 검증</button><br>
  <input id="query" placeholder="검색어 입력 (예: UAM national strategy)" size="50">
  <button onclick="runFullTest()">3️⃣ FullTest 실행</button>

  <h3>결과:</h3>
  <pre id="result"></pre>

<script>
const base = "https://cross-verified-ai-proxy.onrender.com";
let token = "";

async function getToken() {
  const email = document.getElementById("email").value;
  const name = document.getElementById("name").value;
  const res = await fetch(`${base}/auth/dev-token`, {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({ email, name })
  });
  const data = await res.json();
  token = data.token;
  document.getElementById("tokenDisplay").textContent = token;
}

async function verifyToken() {
  const res = await fetch(`${base}/auth/verify`, {
    headers: { Authorization: `Bearer ${token}` }
  });
  document.getElementById("result").textContent = JSON.stringify(await res.json(), null, 2);
}

async function runFullTest() {
  const query = document.getElementById("query").value;
  const res = await fetch(`${base}/proxy/fulltest`, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      Authorization: `Bearer ${token}`
    },
    body: JSON.stringify({ query })
  });
  document.getElementById("result").textContent = JSON.stringify(await res.json(), null, 2);
}
</script>
</body>
</html>
